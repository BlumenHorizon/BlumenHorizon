#!/bin/bash

# üìã –°–ø–∏—Å–æ–∫ –≤–µ—Ç–æ–∫ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
branches=(
    "main-athens"
    "main-madrid"
    "main-globally"
    "main-larnaca"
    "main-limassol"
    "main-paris"
    "main-monaco"
    "main-cannes"
)

# üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏
current_branch=$(git branch --show-current)
if [[ "$current_branch" != "main" ]]; then
    echo "‚ùå –û—à–∏–±–∫–∞: –í—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ –≤–µ—Ç–∫–µ **main** –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–∫—Ä–∏–ø—Ç–∞."
    exit 1
fi

echo "üöÄ **–ù–∞—á–∏–Ω–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ç–æ–∫**..."
echo "========================================"

# üîÑ –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º –≤–µ—Ç–∫–∞–º –∏ —Å–ª–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
for branch in "${branches[@]}"; do
    echo "üîÄ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ç–∫—É ¬´$branch¬ª..."
    git switch "$branch" && git merge main
    
    if [[ $? -ne 0 ]]; then
        echo ""
        echo "‚ö†Ô∏è –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ —Å–ª–∏—è–Ω–∏–∏ —Å ¬´$branch¬ª!"
        echo "üìù –†–∞–∑—Ä–µ—à–∏—Ç–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤—Ä—É—á–Ω—É—é –∏ –∑–∞–≤–µ—Ä—à–∏—Ç–µ —Å–ª–∏—è–Ω–∏–µ."
        echo ""
        git merge --quit
        exit 1
    fi
    
    echo "üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π..."
    git push origin "$branch"
    
    echo "‚úÖ –í–µ—Ç–∫–∞ ¬´$branch¬ª —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!"
    echo "========================================"
    echo ""
done

# üè† –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É
git switch main

echo ""
echo "üéâ –í—Å–µ –≤–µ—Ç–∫–∏ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!"
echo "========================================"